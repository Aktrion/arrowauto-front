<div class="space-y-6">
  <!-- Header -->
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
    <div>
      <h1 class="text-2xl font-bold text-base-content">{{ 'DASHBOARD.TITLE' | translate }}</h1>
      <p class="text-base-content/60">{{ 'DASHBOARD.WELCOME' | translate }}</p>
    </div>
    <a routerLink="/vehicles-instances/new" class="btn btn-primary">
      <lucide-icon [name]="icons.Plus" class="h-5 w-5"></lucide-icon>
      {{ 'DASHBOARD.NEW_VEHICLE' | translate }}
    </a>
  </div>

  <!-- Quick Search -->
  <div
    class="card bg-base-100 shadow-xl border border-base-200 p-4 flex flex-col sm:flex-row gap-3"
  >
    <div class="flex-1 relative">
      <lucide-icon
        [name]="icons.Search"
        class="h-5 w-5 absolute left-2 top-1/2 -translate-y-1/2 text-base-content/40"
      ></lucide-icon>
      <input
        type="text"
        class="w-full pl-10 pr-4 py-3 bg-base-200 border-0 rounded-xl focus:ring-2 focus:ring-primary/20 focus:bg-base-100 transition-all text-sm"
        [placeholder]="'DASHBOARD.SEARCH_PLACEHOLDER' | translate"
        [(ngModel)]="searchQuery"
        (keydown.enter)="quickSearch()"
      />
    </div>
    <div class="flex gap-2 w-full sm:w-auto">
      <app-select
        [options]="searchFieldOptions"
        [selectedValue]="searchField"
        (selectionChange)="searchField = $event"
        [clearable]="false"
        class="flex-1 sm:w-40"
      ></app-select>
      <button
        class="btn btn-primary whitespace-nowrap"
        (click)="quickSearch()"
        [disabled]="isSearching || !searchQuery.trim()"
      >
        @if (isSearching) {
          <span class="loading loading-spinner loading-sm"></span>
        } @else {
          <lucide-icon [name]="icons.ArrowRight" class="h-4 w-4"></lucide-icon>
          {{ 'DASHBOARD.FIND' | translate }}
        }
      </button>
    </div>
  </div>

  <!-- Stats Grid -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
    <!-- Active Vehicles -->
    <div class="card bg-base-100 shadow-xl border border-base-200">
      <div class="card-body p-5">
        <div class="flex items-start justify-between">
          <div>
            <p class="text-sm font-medium text-base-content/60">
              {{ 'DASHBOARD.STATS.ACTIVE_VEHICLES' | translate }}
            </p>
            <p class="text-3xl font-bold text-base-content mt-1">{{ stats().activeVehicles }}</p>
          </div>
          <div class="w-10 h-10 rounded-lg bg-primary flex items-center justify-center">
            <lucide-icon [name]="icons.Car" class="h-5 w-5 text-primary-content"></lucide-icon>
          </div>
        </div>
        <div class="mt-3 flex items-center gap-2">
          <span class="text-sm text-success font-medium flex items-center gap-1">
            <lucide-icon [name]="icons.TrendingUp" class="h-4 w-4"></lucide-icon>
            +12%
          </span>
          <span class="text-xs text-base-content/50">{{
            'DASHBOARD.STATS.FROM_YESTERDAY' | translate
          }}</span>
        </div>
      </div>
    </div>

    <!-- Pending Inspections -->
    <div class="card bg-base-100 shadow-xl border border-base-200">
      <div class="card-body p-5">
        <div class="flex items-start justify-between">
          <div>
            <p class="text-sm font-medium text-base-content/60">
              {{ 'DASHBOARD.STATS.PENDING_INSPECTIONS' | translate }}
            </p>
            <p class="text-3xl font-bold text-base-content mt-1">
              {{ stats().pendingInspections }}
            </p>
          </div>
          <div class="w-10 h-10 rounded-lg bg-warning flex items-center justify-center">
            <lucide-icon
              [name]="icons.ClipboardCheck"
              class="h-5 w-5 text-warning-content"
            ></lucide-icon>
          </div>
        </div>
        <div class="mt-3">
          <span class="text-sm text-warning font-medium"
            >âš¡ {{ 'DASHBOARD.STATS.REQUIRES_ATTENTION' | translate }}</span
          >
        </div>
      </div>
    </div>

    <!-- Awaiting Approval -->
    <div class="card bg-base-100 shadow-xl border border-base-200">
      <div class="card-body p-5">
        <div class="flex items-start justify-between">
          <div>
            <p class="text-sm font-medium text-base-content/60">
              {{ 'DASHBOARD.STATS.AWAITING_APPROVAL' | translate }}
            </p>
            <p class="text-3xl font-bold text-base-content mt-1">{{ stats().awaitingApproval }}</p>
          </div>
          <div class="w-10 h-10 rounded-lg bg-info flex items-center justify-center">
            <lucide-icon [name]="icons.Clock" class="h-5 w-5 text-info-content"></lucide-icon>
          </div>
        </div>
        <div class="mt-3">
          <span class="text-sm text-info font-medium"
            >ðŸ“§ {{ 'DASHBOARD.STATS.CUSTOMER_RESPONSE_PENDING' | translate }}</span
          >
        </div>
      </div>
    </div>

    <!-- Revenue Today -->
    <div class="card bg-base-100 shadow-xl border border-base-200">
      <div class="card-body p-5">
        <div class="flex items-start justify-between">
          <div>
            <p class="text-sm font-medium text-base-content/60">
              {{ 'DASHBOARD.STATS.REVENUE_TODAY' | translate }}
            </p>
            <p class="text-3xl font-bold text-base-content mt-1">
              Â£{{ stats().totalRevenue | number: '1.0-0' }}
            </p>
          </div>
          <div class="w-10 h-10 rounded-lg bg-success flex items-center justify-center">
            <lucide-icon
              [name]="icons.CreditCard"
              class="h-5 w-5 text-success-content"
            ></lucide-icon>
          </div>
        </div>
        <div class="mt-3 flex items-center gap-2">
          <span class="text-sm text-success font-medium flex items-center gap-1">
            <lucide-icon [name]="icons.TrendingUp" class="h-4 w-4"></lucide-icon>
            +8%
          </span>
          <span class="text-xs text-base-content/50">{{
            'DASHBOARD.STATS.FROM_LAST_WEEK' | translate
          }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content Grid -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Recent Vehicles Table -->
    <div class="lg:col-span-2">
      <div class="card bg-base-100 shadow-sm border border-base-200 overflow-hidden">
        <div class="p-6 border-b border-base-200">
          <div class="flex items-center justify-between">
            <div>
              <h2 class="text-lg font-semibold text-base-content">
                {{ 'DASHBOARD.RECENT_VEHICLES.TITLE' | translate }}
              </h2>
              <p class="text-sm text-base-content/60">
                {{ 'DASHBOARD.RECENT_VEHICLES.SUBTITLE' | translate }}
              </p>
            </div>
            <a
              routerLink="/vehicles-instances"
              class="btn btn-ghost btn-sm text-primary hover:bg-primary/10"
            >
              {{ 'DASHBOARD.RECENT_VEHICLES.VIEW_ALL' | translate }}
              <lucide-icon [name]="icons.ChevronRight" class="h-4 w-4"></lucide-icon>
            </a>
          </div>
        </div>
        <app-data-grid [config]="gridConfig" (stateChange)="handleRecentStateChange($event)" />
      </div>
    </div>

    <!-- Right Column -->
    <div class="space-y-6">
      <!-- Quick Actions -->
      <div class="card bg-base-100 shadow-xl border border-base-200 p-6">
        <h2 class="text-lg font-semibold text-base-content mb-4">
          {{ 'DASHBOARD.QUICK_ACTIONS.TITLE' | translate }}
        </h2>
        <div class="grid grid-cols-2 gap-3">
          <a
            routerLink="/vehicles-instances/new"
            class="flex flex-col items-center gap-3 p-4 rounded-xl border border-base-200 hover:bg-base-200 transition-colors cursor-pointer"
          >
            <div class="w-12 h-12 rounded-lg bg-primary flex items-center justify-center">
              <lucide-icon [name]="icons.Plus" class="h-6 w-6 text-primary-content"></lucide-icon>
            </div>
            <span class="text-sm font-medium text-base-content">{{
              'DASHBOARD.NEW_VEHICLE' | translate
            }}</span>
          </a>
          <a
            routerLink="/inspection"
            class="flex flex-col items-center gap-3 p-4 rounded-xl border border-base-200 hover:bg-base-200 transition-colors cursor-pointer"
          >
            <div class="w-12 h-12 rounded-lg bg-warning flex items-center justify-center">
              <lucide-icon
                [name]="icons.ClipboardCheck"
                class="h-6 w-6 text-warning-content"
              ></lucide-icon>
            </div>
            <span class="text-sm font-medium text-base-content">{{
              'DASHBOARD.QUICK_ACTIONS.INSPECTION' | translate
            }}</span>
          </a>
          <a
            routerLink="/scheduling"
            class="flex flex-col items-center gap-3 p-4 rounded-xl border border-base-200 hover:bg-base-200 transition-colors cursor-pointer"
          >
            <div class="w-12 h-12 rounded-lg bg-info flex items-center justify-center">
              <lucide-icon [name]="icons.Calendar" class="h-6 w-6 text-info-content"></lucide-icon>
            </div>
            <span class="text-sm font-medium text-base-content">{{
              'DASHBOARD.QUICK_ACTIONS.SCHEDULE' | translate
            }}</span>
          </a>
          <a
            routerLink="/invoicing"
            class="flex flex-col items-center gap-3 p-4 rounded-xl border border-base-200 hover:bg-base-200 transition-colors cursor-pointer"
          >
            <div class="w-12 h-12 rounded-lg bg-success flex items-center justify-center">
              <lucide-icon
                [name]="icons.FileText"
                class="h-6 w-6 text-success-content"
              ></lucide-icon>
            </div>
            <span class="text-sm font-medium text-base-content">{{
              'DASHBOARD.QUICK_ACTIONS.INVOICE' | translate
            }}</span>
          </a>
        </div>
      </div>

      <!-- Available Operators -->
      <div class="card bg-base-100 shadow-xl border border-base-200 p-6">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-lg font-semibold text-base-content">
            {{ 'DASHBOARD.OPERATORS.TITLE' | translate }}
          </h2>
          <span class="badge badge-success badge-sm">
            {{ operators().length }} {{ 'DASHBOARD.OPERATORS.ONLINE' | translate }}
          </span>
        </div>
        <div class="space-y-3">
          @for (operator of operators().slice(0, 4); track operator.id!) {
            <div
              class="flex items-center gap-3 p-3 rounded-xl border border-base-200 hover:bg-base-200 transition-colors"
            >
              <div class="relative">
                <div
                  class="w-10 h-10 rounded-lg bg-secondary flex items-center justify-center text-secondary-content font-semibold text-sm"
                >
                  {{ getInitials(operator.name) }}
                </div>
                <div
                  class="absolute bottom-0 right-0 w-3 h-3 rounded-full bg-success border-2 border-white"
                ></div>
              </div>
              <div class="flex-1 min-w-0">
                <p class="text-sm font-semibold text-base-content truncate">{{ operator.name }}</p>
                <p class="text-xs text-base-content/50">
                  {{ 'DASHBOARD.OPERATORS.AVAILABLE' | translate }}
                </p>
              </div>
              <div class="w-16">
                <div class="h-1.5 bg-base-200 rounded-full overflow-hidden">
                  <div class="h-full bg-success rounded-full" style="width: 30%"></div>
                </div>
                <p class="text-xs text-base-content/50 mt-1">
                  30% {{ 'DASHBOARD.OPERATORS.BUSY' | translate }}
                </p>
              </div>
            </div>
          }
        </div>
      </div>
    </div>
  </div>
</div>
